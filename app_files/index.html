<!DOCTYPE html>
<html>
  <head>
  	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  	<link rel="stylesheet" href="static/chosen.min.css"/>
  	<link rel="stylesheet" href="static/style.css"/>
  	<link rel="stylesheet" href="static/prism.css"/>
  </head>

  <style>

  input[type="radio"]{
  	margin: 0 10px 0 10px;
  }

  em{
  	margin-left: 50px;
  	font-family: Arial;
  	font-size: 150%;
  }

  .btn-primary{
  	margin-left: 30px;
  }

  #red-flavors{
  	margin-left: 20px;
  }

  #white-flavors{
  	position: absolute;
  	margin-left: 360px;
  }

  #flavors-pairings{
  	position: absolute;
  	margin-left: 700px;
  }
  </style>

  <body>

  		<div id="title" class="wrapper">
	    <h2>Find a Delicious Wine from Your Flavor Selection</h2>
	    <p class="space"></p>
	    <div id="characteristics"></div>
	    </div>

	    <div class="side-by-side clearfix">
		    <div class="flavors" id="red-flavors">
	          <em style="color:#FF0000;text-shadow: 1px 0 black, 0 1px black, 1px 0 black, 0 1px black;">Red Wine Flavors</em>
	          <select data-placeholder="Flavors" style="width:300px;" class="chosen-select" multiple tabindex="6">
	            <option value=""></option>
	            <optgroup label="FRUIT">
	              <option>Strawberry</option>
	              <option>Raspberry</option>
	              <option>Blackberry</option>
	              <option>Cherry</option>
	            </optgroup>
	            <optgroup label="SAVORY">
	              <option>Caramel</option>
	              <option>Toffee</option>
	              <option>Leather</option>
	              <option>Cedar</option>
	            </optgroup>
	          </select>
	        </div>
	        <div class="flavors" id="white-flavors">
	          <em style="color:Khaki;text-shadow: 1px 0 black, 0 1px black, 1px 0 black, 0 1px black;">White Wine Flavors</em>
	          <select data-placeholder="Flavors" style="width:300px;" class="chosen-select" multiple tabindex="6">
	            <option value=""></option>
	            <optgroup label="FRUIT">
	              <option>Strawberry</option>
	              <option>Lemon</option>
	              <option>Peach</option>
	              <option>Grapefruit</option>
	            </optgroup>
	            <optgroup label="SAVORY">
	              <option>Vanilla</option>
	              <option>Citrus</option>
	              <option>Pineapple</option>
	              <option>Flavor</option>
	            </optgroup>
	          </select>
	        </div>
	        <div id="flavors-pairings">
	          <em style="color:CornflowerBlue;text-shadow: 1px 0 black, 0 1px black, 1px 0 black, 0 1px black;">Common Pairings</em>
	          <select data-placeholder="Choose a Pairing..." style="width:300px;" class="chosen-select" tabindex="2">
	            <option value=""></option>
	             <option>Raspberry, Strawberry, Tart, Cranberry</option>
	             <option>Blueberry, Licorice, Raspberry, Smoke</option>
	             <option>Blackberry, Tobacco, Coffee</option>
	             <option>Citrus, Lemon, Peach, Melon, Tropical</option>
	             <option>Orange, Caramel, Apricot, Vanilla</option>
	             <option>Vanilla, Oak, Pineapple, Butter</option>
	          </select>
	          <button type="button" id="wine-button" class="btn btn-primary btn-sm">Find Wines</button>
	        </div>
        </div>

		<div id="wine_area">
			<h2>Wine Results</h2>
			<h4 id="name1"></h4>
			<h4 id="varietal1"></h4>
			<h4 id="points1"></h4>
			<p id="review1"></p>
			<h4 id="name2"></h4>
			<h4 id="varietal2"></h4>
			<h4 id="points2"></h4>
			<p id="review2"></p>
			<h4 id="name3"></h4>
			<h4 id="varietal3"></h4>
			<h4 id="points3"></h4>
			<p id="review3"></p>
			<h4 id="name4"></h4>
			<h4 id="varietal4"></h4>
			<h4 id="points4"></h4>
			<p id="review4"></p>
			<h4 id="name5"></h4>
			<h4 id="varietal5"></h4>
			<h4 id="points5"></h4>
			<p id="review5"></p>
		</div>


	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js" type="text/javascript"></script>
	<script scr="http://code.jquery.com/jquery-1.11.2.min.js"></script>
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="static/chosen.jquery.min.js" type="text/javascript" ></script>
	<script src="static/prism.js" type="text/javascript" ></script>
	<script type="text/javascript">

		var config = {
      		'.chosen-select'           : {},
      		'.chosen-select-deselect'  : {allow_single_deselect:true},
      		'.chosen-select-no-single' : {disable_search_threshold:10},
      		'.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
      		'.chosen-select-width'     : {width:"95%"}
    	}

    	for (var selector in config) {
      		$(selector).chosen(config[selector]);
	    }	

	    $('#wine-button').on('click', function () {
	    	get_probability();
	    });

             
		function get_probability(){

			//foo = $('#red-flavors').find(".chosen-choices").text();
			if ($('.flavors').find(".chosen-choices").text().length == 0){
				wine_features = $('#flavors-pairings').find(".chosen-single").text();
			}
			else {
				wine_features = $('.flavors').find(".chosen-choices").text();
			};

			//Get an array of all selected radio inputs
			//wine_features = $.map($("input:radio:checked"), function(elem){return $(elem).val();});
			console.log(wine_features)

			//feature_array = wine_features.join(', ');
			//console.log([feature_array]);
			descriptors = JSON.stringify({descriptions: wine_features});
			console.log(descriptors);

            $.ajax({
     		type: "POST",
     		contentType: "application/json; charset=utf-8",
     		url: "/wines",
     		dataType: "json",
     		async: true,
     		data: descriptors,
     		success: function (data) {
     			for (var i = 0; i < 5; i++) {
	     			$("#name" + (i+1)).html("Wine Name: " + '   ' + data['wine'][i]['wine/name']);
					$("#varietal" + (i+1)).html("Wine Variant: " + '   ' + data['wine'][i]['wine/variant']);
	     			$("#points" + (i+1)).html("Average Review Points: " + '   ' + data['wine'][i]['review/points']);
	     			$("#review" + (i+1)).html(data['wine'][i]['review/text']);
     			}
     			
				console.log(data)

     		},
     		error: function (result) {
         		console.log(result);}
       		})
              };
	</script>
   </body>
</html>