<!DOCTYPE html>
<html>
  <head>
  	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  	<link rel="stylesheet" href="static/chosen.min.css"/>
  	<link rel="stylesheet" href="static/style.css"/>

  </head>

  <style>

  h2{
  	margin-left: 450px;
  	font-size: 300%;
  	margin-top: 20px;
  }

  em{
  	margin-left: 50px;
  	font-family: Arial;
  	font-size: 150%;
  }

  #wine-button{
  	margin-left: 500px;
  }

  #red-flavors{
  	margin-left: 80px;
  }

  #white-flavors{
  	position: absolute;
  	margin-left: 450px;
  }

  #flavors-pairings{
  	position: absolute;
  	margin-left: 800px;
  }


  </style>

  <body>

  		<div id="title" class="wrapper" style="color: #006699;text-shadow: 1px 0 black, 0 1px black, 1px 0 black, 0 1px black;">
	    <h2>Fl@vor F@ve</h2>
	    </div>

	    <hr>

	    <div class="side-by-side clearfix">
		    <div class="flavors" id="red-flavors">
	          <em style="color:#FF0000;text-shadow: 1px 0 black, 0 1px black, 1px 0 black, 0 1px black;">Red Wine Flavors</em>
	          <select data-placeholder="Flavors" style="width:300px;" class="chosen-select" multiple tabindex="6">
	            <option value=""></option>
	            <optgroup label="FRUIT">
	              <option>Strawberry</option>
	              <option>Raspberry</option>
	              <option>Blackberry</option>
	              <option>Cherry</option>
	              <option>Blueberry</option>
	            </optgroup>
	            <optgroup label="SWEET/SALTY">
	              <option>Caramel</option>
	              <option>Toffee</option>
	              <option>Raisin</option>
	              <option>Licorice</option>
	              <option>Mocha</option>
	             <optgroup label="OTHER">
	              <option>Leather</option>
	              <option>Cedar</option>
	              <option>Coffee</option>
	              <option>Spice</option>
	            </optgroup>
	          </select>
	        </div>
	        <div class="flavors" id="white-flavors">
	          <em style="color:Khaki;text-shadow: 1px 0 black, 0 1px black, 1px 0 black, 0 1px black;">White Wine Flavors</em>
	          <select data-placeholder="Flavors" style="width:300px;" class="chosen-select" multiple tabindex="6">
	            <option value=""></option>
	            <optgroup label="FRUIT">
	              <option>Strawberry</option>
	              <option>Lemon</option>
	              <option>Lime</option>
	              <option>Peach</option>
	              <option>Grapefruit</option>
	              <option>Orange</option>
	              <option>Apple</option>
	              <option>Melon</option>
	              <option>Pineapple</option>
	              <option>Watermelon</option>
	            </optgroup>
	            <optgroup label="SWEET/TART">
	              <option>Vanilla</option>
	              <option>Apricot</option>
	              <option>Citrus</option>
	  			  <option>Tropical</option>
	  			  <option>Stone</option>
	  			  <option>Creamy</option>
	  			  <option>Butter</option>
	  			  <option>Spice</option>
	            </optgroup>
	          </select>
	        </div>
	        <div id="flavors-pairings">
	          <em style="color:CornflowerBlue;text-shadow: 1px 0 black, 0 1px black, 1px 0 black, 0 1px black;">Common Pairings</em>
	          <select data-placeholder="Choose a Pairing..." style="width:300px;" class="chosen-select" tabindex="2">
	            <option value=""></option>
	             <option>Raspberry, Strawberry, Tart, Cranberry</option>
	             <option>Blueberry, Licorice, Raspberry, Smoke</option>
	             <option>Blackberry, Tobacco, Coffee</option>
	             <option>Citrus, Lemon, Peach, Melon, Tropical</option>
	             <option>Orange, Caramel, Apricot, Vanilla</option>
	             <option>Vanilla, Oak, Pineapple, Butter</option>
	             <option>Cassis, Cedar, Tobacco, Leather, Coffee</option>
	             <option>Tawny, Caramel, Raisin, Nutty, Maple, Toffee</option>
	             <option>Caramel, Orange, Nutty, Apricot, Spice</option>
	             <option>Strawberry, Salmon, Cherry, Watermelon</option>
	          </select>
	        </div>
	        <div style="padding-top:20px;">
	          <button type="button" id="wine-button" class="btn btn-primary btn-sm">Find Wines</button>
	      	</div>
	      	<div style="padding-top:20px;">
	          <button type="button" id="reset-button" class="btn btn-primary btn-sm">Clear</button>
	        </div>
        </div>

        <hr>

		<div style="margin-left:550px; padding-bottom:30px; text-decoration: underline;" id="wine_area">
			<h3>Wine Results</h3>
		</div>
		<div class="side-by-side clearfix">
 			<div style="padding-left:50px;" id="wine0">
 				<span id="name0"></span>
 			</div>
 			<div style="padding-left:70px;" id="wine1">
			</div>
			<div style="padding-left:50px;" id="wine2">
			</div>		
			<div style="padding-left:70px;" id="wine3">
			</div>
			<div style="padding-left:50px;" id="wine4">
			</div>
		</div>

	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js" type="text/javascript"></script>
	<script scr="http://code.jquery.com/jquery-1.11.2.min.js"></script>
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="static/chosen.jquery.min.js" type="text/javascript" ></script>
	<script src="static/prism.js" type="text/javascript" ></script>
	<script type="text/javascript">

		var config = {
      		'.chosen-select'           : {},
      		'.chosen-select-deselect'  : {allow_single_deselect:true},
      		'.chosen-select-no-single' : {disable_search_threshold:10},
      		'.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
      		'.chosen-select-width'     : {width:"95%"}
    	}

    	for (var selector in config) {
      		$(selector).chosen(config[selector]);
	    }	

	    $('#wine-button').on('click', function () {
	    	get_wines();
	    	$(".btn-group button").removeClass("active");
	    });

	    $('#reset-button').on('click', function () {
	    	$(".chosen-select").val('').trigger("chosen:updated");
	    });

             
		function get_wines(){

			if ($('.flavors').find(".chosen-choices").text().length == 0){
				wine_features = $('#flavors-pairings').find(".chosen-single").text();
			}
			else {
				wine_features = $('.flavors').find(".chosen-choices").text();
			};

			console.log(wine_features)

			descriptors = JSON.stringify({descriptions: wine_features});
			console.log(descriptors);

            $.ajax({
     		type: "POST",
     		contentType: "application/json; charset=utf-8",
     		url: "/wines",
     		dataType: "json",
     		async: true,
     		data: descriptors,
     		success: function (data) {

     			var wine0 = document.getElementById("wine0");
     			var wine1 = document.getElementById("wine1");
     			var wine2 = document.getElementById("wine2");
     			var wine3 = document.getElementById("wine3");
     			var wine4 = document.getElementById("wine4");

     			var wines = [wine0, wine1, wine2, wine3, wine4];

     			/*for (var i = 0; i < 5; i++){
     				wines[i].innerHTML = '';
     				wines[i].innerHTML += 'Name: ' + data['wine'][i]['wine/name'] + "<br>" + 
     				'Wine Variant: ' + data['wine'][i]['wine/variant'] + "<br>" + 
     				'Avg Review Points: ' + data['wine'][i]['review/points'] + "<br>" 
     			};*/

     			$("#name0").html('Name: ' + data['wine'][0]['wine/name']);
     			
				console.log(data)

     		},
     		error: function (result) {
         		console.log(result);}
       		})
              };
	</script>
   </body>
</html>